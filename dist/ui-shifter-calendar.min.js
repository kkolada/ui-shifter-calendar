!function(){"use strict";!function(){angular.module("UI.Shifter.Calendar",[])}(),angular.module("UI.Shifter.Calendar",["src/templates/ui-shifter-calendar.tpl.html"]),angular.module("src/templates/ui-shifter-calendar.tpl.html",[]).run(["$templateCache",function(a){a.put("src/templates/ui-shifter-calendar.tpl.html","<div class=ui-shifter-calendar><table ng-class=\"['ui-shifter-calendar-week-wrapper', {shadow: vm.shadow}]\"><thead><tr><th></th><th ng-if=vm.dayFilter.mon>Monday</th><th ng-if=vm.dayFilter.tue>Tuesday</th><th ng-if=vm.dayFilter.wed>Wednesday</th><th ng-if=vm.dayFilter.thu>Thursday</th><th ng-if=vm.dayFilter.fri>Friday</th><th ng-if=vm.dayFilter.sat>Saturday</th><th ng-if=vm.dayFilter.sun>Sunday</th></tr><tr class=subhead><th></th><th ng-if=vm.dayFilter.mon>Team</th><th ng-if=vm.dayFilter.tue>Team</th><th ng-if=vm.dayFilter.wed>Team</th><th ng-if=vm.dayFilter.thu>Team</th><th ng-if=vm.dayFilter.fri>Team</th><th ng-if=vm.dayFilter.sat>Team</th><th ng-if=vm.dayFilter.sun>Team</th></tr></thead><tbody><tr class=first-half-hour ng-repeat-start=\"hour in vm.hours track by $index\"><td id=\"{{vm.id + '-' + hour.time}}\">{{hour.time}}</td><td id=\"{{vm.id + '-' + hour.time + '-Monday'}}\" ng-if=vm.dayFilter.mon></td><td id=\"{{vm.id + '-' + hour.time + '-Tuesday'}}\" ng-if=vm.dayFilter.tue></td><td id=\"{{vm.id + '-' + hour.time + '-Wednesday'}}\" ng-if=vm.dayFilter.wed></td><td id=\"{{vm.id + '-' + hour.time + '-Thursday'}}\" ng-if=vm.dayFilter.thu></td><td id=\"{{vm.id + '-' + hour.time + '-Friday'}}\" ng-if=vm.dayFilter.fri></td><td id=\"{{vm.id + '-' + hour.time + '-Saturday'}}\" ng-if=vm.dayFilter.sat></td><td id=\"{{vm.id + '-' + hour.time + '-Sunday'}}\" ng-if=vm.dayFilter.sun></td></tr><tr class=second-half-hour ng-repeat-end><td>&nbsp;</td><td ng-if=vm.dayFilter.mon></td><td ng-if=vm.dayFilter.tue></td><td ng-if=vm.dayFilter.wed></td><td ng-if=vm.dayFilter.thu></td><td ng-if=vm.dayFilter.fri></td><td ng-if=vm.dayFilter.sat></td><td ng-if=vm.dayFilter.sun></td></tr></tbody></table></div>")}]),function(){angular.module("UI.Shifter.Calendar").constant("$moment",moment).constant("eventConst",{BOOKING:"booking"})}(),function(){function a(a,b,c,d,e){var f=this;f.hours=[];var g=function(a,b){for(var d=[],e=a;e<=b;e++)d.push({time:c({hour:e,minute:0}).format("HH:mm")});f.hours=d},h=function(){i(),f.events.forEach(function(a){e.createBooking(f.id,f.id+"-"+a.from.substring(0,2)+":00-"+a.day,a)})},i=function(){for(var a=b[0].getElementsByClassName(d.BOOKING);a.length>0;)a[0].parentNode.removeChild(a[0])};a.$watch("vm.timeFilter",function(a,c){g(a.start,a.end),angular.element(b[0]).ready(function(){h()})},!0),a.$watch("vm.dayFilter",function(a,c){angular.element(b[0]).ready(function(){h()})},!0),a.$watch("vm.events",function(a,c){angular.element(b[0]).ready(function(){h()})},!0),angular.element(b[0]).ready(function(){h()})}angular.module("UI.Shifter.Calendar").controller("uiShifterCalendarCtrl",["$scope","$document","$moment","eventConst","uiShifterCalendarEvent",a])}(),function(){function a(a){}function b(){return{restrict:"AE",templateUrl:"src/templates/ui-shifter-calendar.tpl.html",controller:"uiShifterCalendarCtrl",controllerAs:"vm",scope:{id:"@",events:"=",timeFilter:"=",dayFilter:"=",shadow:"="},bindToController:!0,link:a}}angular.module("UI.Shifter.Calendar").directive("uiShifterCalendar",b)}(),function(){function a(a,b,c,d){function e(a,b){var d=a.substring(0,2),e=a.substring(3,5),f=b.substring(0,2),g=b.substring(3,5),h=c({hour:d,minute:e});return c({hour:f,minute:g}).diff(h,"minutes")}function f(a,b){var c=a.substring(0,2)+":00",d=e(c,a),f=0;if(d>0){var g=d%30,h=(d-g)/30,i=g/30;f=b*h+Math.round(b*i+.5)-2}return f}function g(a,b){var c=a%30,d=(a-c)/30,e=c/30;return b*d+Math.round(b*e+.5)-5}function h(a,b){var c=parseInt(b.substring(0,1)),d=parseInt(b.substring(2,3)),e=c/d;return Math.round(a*e)-5}function i(c,d,e){var f=a[0].getElementById(c+"-"+e.substring(0,2)+":00-"+d);if(null!==f)var g=f.getBoundingClientRect(),h=Math.round(g.top),i=Math.round(g.left),j=Math.round(g.width),k=Math.round(g.height);return{left:b.scrollX+i+3,top:b.scrollY+h+2,width:j,height:k}}var j={};return j.createBooking=function(b,c,j){var k=i(b,j.day,j.from),l=angular.element('<div class="'+d.BOOKING+'"><span>'+j.fraction+"<br>"+j.from+" - "+j.to+"</span></div>"),m=g(e(j.from,j.to),k.height),n=h(k.width,j.fraction);m&&NaN!==m&&(l[0].style.height=m+"px"),n&&NaN!==n&&(l[0].style.width=n+"px");var o=k.left,p=k.top;p+=f(j.from,k.height),l[0].style.top=o+"px",l[0].style.top=p+"px";var q=a[0].getElementById(c);angular.element(q).append(l)},j}angular.module("UI.Shifter.Calendar").factory("uiShifterCalendarEvent",["$document","$window","$moment","eventConst",a])}()}();